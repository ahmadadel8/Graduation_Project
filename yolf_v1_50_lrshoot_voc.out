2020-08-08 02:16:41.050700: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-08-08 02:16:45.948640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.17GiB freeMemory: 11.11GiB
2020-08-08 02:16:45.948753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2020-08-08 02:16:51.149333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-08-08 02:16:51.149493: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2020-08-08 02:16:51.149522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2020-08-08 02:16:51.149676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10761 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
Traceback (most recent call last):
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1334, in _do_call
    return fn(*args)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1319, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1407, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3,3,256,1] rhs shape= [3,3,512,1]
	 [[{{node save/Assign_346}} = Assign[T=DT_FLOAT, _class=["loc:@stem/conv9/sconv/sconv/depthwise_weights"], use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](stem/conv9/sconv/sconv/depthwise_weights/Adam_1, save/RestoreV2/_699)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1546, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 929, in run
    run_metadata_ptr)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1152, in _run
    feed_dict_tensor, options, run_metadata)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1328, in _do_run
    run_metadata)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1348, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3,3,256,1] rhs shape= [3,3,512,1]
	 [[node save/Assign_346 (defined at nutshell/yolf_mobilenetsv1_50_lr_shoot_darkconv.py:84)  = Assign[T=DT_FLOAT, _class=["loc:@stem/conv9/sconv/sconv/depthwise_weights"], use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](stem/conv9/sconv/sconv/depthwise_weights/Adam_1, save/RestoreV2/_699)]]

Caused by op 'save/Assign_346', defined at:
  File "nutshell/yolf_mobilenetsv1_50_lr_shoot_darkconv.py", line 84, in <module>
    train_saver = tf.train.Saver(max_to_keep=2)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1102, in __init__
    self.build()
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1114, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1151, in _build
    build_save=build_save, build_restore=build_restore)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 795, in _build_internal
    restore_sequentially, reshape)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 428, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 119, in restore
    self.op.get_shape().is_fully_defined())
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 221, in assign
    validate_shape=validate_shape)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 61, in assign
    use_locking=use_locking, name=name)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 488, in new_func
    return func(*args, **kwargs)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3274, in create_op
    op_def=op_def)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1770, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [3,3,256,1] rhs shape= [3,3,512,1]
	 [[node save/Assign_346 (defined at nutshell/yolf_mobilenetsv1_50_lr_shoot_darkconv.py:84)  = Assign[T=DT_FLOAT, _class=["loc:@stem/conv9/sconv/sconv/depthwise_weights"], use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](stem/conv9/sconv/sconv/depthwise_weights/Adam_1, save/RestoreV2/_699)]]


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "nutshell/yolf_mobilenetsv1_50_lr_shoot_darkconv.py", line 115, in <module>
    train_saver.restore(sess,checkpoint_prefix)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1582, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [3,3,256,1] rhs shape= [3,3,512,1]
	 [[node save/Assign_346 (defined at nutshell/yolf_mobilenetsv1_50_lr_shoot_darkconv.py:84)  = Assign[T=DT_FLOAT, _class=["loc:@stem/conv9/sconv/sconv/depthwise_weights"], use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](stem/conv9/sconv/sconv/depthwise_weights/Adam_1, save/RestoreV2/_699)]]

Caused by op 'save/Assign_346', defined at:
  File "nutshell/yolf_mobilenetsv1_50_lr_shoot_darkconv.py", line 84, in <module>
    train_saver = tf.train.Saver(max_to_keep=2)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1102, in __init__
    self.build()
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1114, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1151, in _build
    build_save=build_save, build_restore=build_restore)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 795, in _build_internal
    restore_sequentially, reshape)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 428, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 119, in restore
    self.op.get_shape().is_fully_defined())
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 221, in assign
    validate_shape=validate_shape)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 61, in assign
    use_locking=use_locking, name=name)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 488, in new_func
    return func(*args, **kwargs)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3274, in create_op
    op_def=op_def)
  File "/share/apps/conda_envs/ba-hpc/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1770, in __init__
    self._traceback = tf_stack.extract_stack()

InvalidArgumentError (see above for traceback): Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [3,3,256,1] rhs shape= [3,3,512,1]
	 [[node save/Assign_346 (defined at nutshell/yolf_mobilenetsv1_50_lr_shoot_darkconv.py:84)  = Assign[T=DT_FLOAT, _class=["loc:@stem/conv9/sconv/sconv/depthwise_weights"], use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](stem/conv9/sconv/sconv/depthwise_weights/Adam_1, save/RestoreV2/_699)]]

